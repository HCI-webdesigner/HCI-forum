<?php 
  include ('include_fns.php');
  header("Content-Type:text/html; charset=utf-8");
 
  $titile = $_POST['title'];
  $Poster = $_POST['poster'];
  $message = $_POST['message'];
  
  function loggedIn(){   

    
    if(!$_SESSION['loggd']){   

        echo'<form action="checkLogin.php" method="post">   

        <p>   
            Username:<br>   
            <input type="text" name="username">   
        </p>   

        <p>   
            Password:<br>   
            <input type="password" name="username">   
        </p>   

        <p>   
            <input type="submit" name="submit" value="Log In">   
        </p>   
        </form>';   
    }else{   
          echo 'Welcome, '.$_SESSION['username'];   
    }   
  }   

  if (isset($_GET['parent'])) {
  	  $parent  = $_GET['parent'];
  }  else {
  	$parent = $_POST['parent'];
  }
 
  if (!$area) {
  	 $area = 1;
  }
  
  if (!$error) {
  	if (!$parent) {
  		$parant = 0;
  		if (!$titile) {
  			$titile = 'New Post';
  		}
  	} else {
  		// get post name
  		$titile = get_post_title($parant);
  		//append Re:
  		if (strstr($titile, 'Re: ') == false) {
  			$titile = 'Re: '.$titile;
  		}
  		//make sure title will still fit in db
  		$titile = substr($title, 0, 20);
  		
  		//prepend a quoting pattern to the post you are replying to
  		$message = add_quoting(get_post_message($parant));
  	}
  }
  do_html_header($titile);
  
  display_new_post_form($parent, $area, $title, $message, $poster);
  
  if ($error) {
  	  echo "<p>你的消息未被储存!</p>
  	  <p>确保你已经填写所有信息并再次操作</p>";
  }

  do_html_footer();
  
  //get post name
  $titile = get_post_title($parant);
  
  //append Re
  if (strstr($titile, 'Re: ') == false) {
  	$title = 'Re: '.$titile;
  }
  
  //make sure title still fit in db
  $titile = substr($titile, 0, 20);
  
  //prepend a quoting pattern to the you are replying to
  $message = add_quoting(get_post_message($parant));
?>


























































































?>
